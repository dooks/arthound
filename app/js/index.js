(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){window.ng_hound=function(ng){$(document).ready(function(){var version="0.8.11";$(".version").html(version);window.FastClick.attach(document.body)});if(ng===undefined||ng===null){console.error("Angular not found")}var ng_app=ng.module("ngHound",["ngRoute","rzModule"]);ng_app.config(["$locationProvider","$routeProvider",function($locationProvider,$routeProvider){$locationProvider.html5Mode(true);$routeProvider.when("/",{reloadOnSearch:false})}]);ng_app.base_back=$("#base_back");ng_app.base_view=$("#base_view");ng_app.base_title=$("#base_title_container");ng_app.modal_about=$("#modal_about");ng_app.modal_info=$("#modal_info");ng_app.modal_options=$("#modal_options");ng_app.modal_help=$("#modal_help");ng_app.base_searchbar=$("#base_searchbar");ng_app.searchbar_info=$("#searchbar_info");ng_app.searchbar_message=$("#searchbar_message");ng_app.searchbar_search=$("#searchbar_search");ng_app.base_image=$("#base_image");ng_app.image_overlay=$("#image_overlay");ng_app.overlay_info=$("#overlay_info");ng_app.overlay_list=$("#overlay_list");ng_app.overlay_next=$("#overlay_next");ng_app.overlay_prev=$("#overlay_prev");ng_app.image_front=$("#image_front");ng_app.image_back=$("#image_back");ng_app.base_listing=$("#base_listing");ng_app.page_next=$("#page_next");ng_app.page_prev=$("#page_prev");return ng_app}(angular)},{}],2:[function(require,module,exports){(function(ng_app){ng_app.controller("ViewCtrl",["$scope","State",function($scope,State){var self=this;self.state=State.state;self.substates=State.substates;$scope.$on("onstatechange",function(){self.state=State.state});$scope.$on("onsubstatechange",function(){self.substates=State.substates})}]);ng_app.controller("LoadingCtrl",["$scope","State",function($scope,State){var self=this;self.state=State.state;self.substates=State.substates;$scope.$on("onstatechange",function(){self.state=State.state});$scope.$on("onsubstatechange",function(){self.substates=State.substates})}]);ng_app.controller("TitleCtrl",["$scope","State",function($scope,State){var self=this;self.state=State.state;self.substates=State.substates;$scope.$on("onstatechange",function(){self.state=State.state})}]);ng_app.controller("SearchbarCtrl",["$scope","State","Keyboard","Search","Navigate","$location",function($scope,State,Keyboard,Search,Navigate,$location){var self=this;self.query="";self.state=State.state;self.substates=State.substates;$scope.$on("onstatechange",function(){self.state=State.state});$scope.$on("onsubstatechange",function(){self.substates=State.substates});$(document).ready(function(){var query=$location.search();if(query.q){if(query.page)Navigate.current_page=query.page;Search.resetSources();State.changeSubstate("LOAD",true);Search.get(query.q,query.page||undefined,query.limit||undefined)}});$scope.$on("onkeyarrow",function(){if(State.substates["SEARCH"]){if(Keyboard.ord==="UP"){self.query=Search.last_query;$scope.$apply()}else{ng_app.searchbar_search.focus()}}});$scope.$on("onkeyup",function(){ng_app.searchbar_search.focus();if(!State.substates["SEARCH"]){$scope.$apply();State.changeSubstate("SEARCH",true);ng_app.searchbar_search.focus()}});$scope.$on("onkeybackspace",function(){if(self.query==="")State.changeSubstates("SEARCH",false);$scope.$apply()});$scope.$on("onkeyenter",function(){if(State.substates["SEARCH"]&&State.state!=="LOAD"){State.changeSubstate("FIRST",false);State.changeSubstate("LAST",false);State.changeSubstate("LOAD",true);$location.search("q",self.query);ng_app.searchbar_search.blur();Navigate.initialize();Search.resetSources();Search.get(self.query)}else{State.changeSubstate("SEARCH",true);ng_app.searchbar_search.focus()}});$scope.$on("onkeyesc",function(){if(State.substates["SEARCH"]){Search.clear();self.query="";State.changeSubstate("SEARCH",false)}});$scope.$on("onnosources",function(){if(Navigate.listing_buffer.length===0){State.changeSubstate("LOAD",false);State.changeSubstate("SEARCH",true);self.query="No search results..."}else{State.changeSubstate("LOAD",false);State.changeSubstate("SEARCH",false);self.query=""}})}]);ng_app.controller("ListingCtrl",["$scope","State","Search","Navigate","$location",function($scope,State,Search,Navigate,$location){var self=this;self.listing=[];self.index=0;self.state=State.state;self.substates=State.substates;self.last_page=false;$scope.$on("onstatechange",function(){self.state=State.state});$scope.$on("onsubstatechange",function(){self.substates=State.substates});$scope.$on("onkeyesc",function(){if(State.substates["LIST"]&&State.substates["FULL"]){State.changeSubstate("LIST",false)}});$scope.$on("onnosources",function(){State.changeSubstate("LAST",true)});$scope.$on("onnavigate",function(){self.current=Navigate.index;if(State.substates["FULL"]){State.changeSubstate("LIST",false)}});$scope.$on("onnavigatepage",function(){if(State.state!=="LOAD"){self.can_page=false;State.changeSubstate("LOAD",true);Search.get(Search.last_query,Navigate.current_page)}});$scope.$on("onsearchreturned",function(){if(Search.response[0].data.length===0){Search.disableSource(Search.response[0].source)}else{Navigate.append(Search.response[0]);self.listing=Navigate.getDisplay(Navigate.listing_buffer)}Search.clearResponse()});$scope.$on("onsearchend",function(){Navigate.reindex();if(Navigate.listing_buffer.length===0){State.changeState("DEFAULT");State.changeState("SEARCH",true);State.changeSubstate("LIST",false);Navigate.listing_buffer.length=0;self.listing.length=0}else{State.changeSubstate("LOAD",false);State.changeSubstate("SEARCH",false);Navigate.can_page=true;self.can_page=true;if(!self.substates["LAST"]){$location.search("page",Navigate.current_page)}if(Navigate.index===0)Navigate.to(0);if(Navigate.page_sizes[0]!==0&&!self.substates["LAST"]){State.changeSubstate("FIRST",true)}State.changeState("ACTIVE");State.changeSubstate("LIST",true);self.listing=Navigate.listing_buffer;console.log("Listing",self.listing)}})}]);ng_app.controller("OverlayCtrl",["$scope","State","Navigate",function($scope,State,Navigate){var self=this;self.state=State.state;self.substates=State.substates;$scope.$on("onstatechange",function(){self.state=State.state});$scope.$on("onsubstatechange",function(){self.substates=State.substates});$scope.$on("onsearchreturned",function(){State.changeSubstate("OVERLAY",true)})}]);ng_app.controller("InfoCtrl",["$scope","Navigate","State",function($scope,Navigate,State){var self=this;self.current={};self.date=0;self.state=State.state;self.substates=State.substates;$scope.$on("onstatechange",function(){self.state=State.state});$scope.$on("onsubstatechange",function(){self.substates=State.substates});$scope.$on("onnavigate",function(){self.current=Navigate.current;if(self.current){var date=new Date(self.current.date*1e3);self.date=date.toDateString()}$scope.$apply()})}]);ng_app.controller("OptionsCtrl",["$scope","$rootScope","Search",function($scope,$rootScope,Search){var self=this;self.Search=Search;self.limit_options={ceil:100,hideLimitLabels:true};$scope.$broadcast("rzSliderForceRender")}]);ng_app.controller("ImageCtrl",["$scope","State","Navigate","Keyboard",function($scope,State,Navigate,Keyboard){var self=this;self.current={};self.state=State.state;self.substates=State.substates;$scope.$on("onstatechange",function(){self.state=State.state});$scope.$on("onsubstatechange",function(){self.substates=State.substates});$scope.$on("onkeyarrow",function(){if(!State.substates["SEARCH"]){switch(Keyboard.ord){case"LEFT":Navigate.prev();break;case"RIGHT":Navigate.next();break}}});$scope.$on("onnavigate",function(){ng_app.image_front.attr("src","");ng_app.image_back.css("background-image","url('')");self.current=Navigate.current;if(self.current){var image="";if(State.substates["FULL"])image=self.current.preview;else image=self.current.content||self.current_preview||self.current.thumbs;if(self.current.zoom){image=self.current.content;ng_app.image_front.attr("src",image)}else{ng_app.image_front.attr("src",image);ng_app.image_back.css("background-image","url('"+image+"')")}$scope.$apply()}else{console.log("Could not find image",Navigate.index)}})}])})(ng_hound)},{}],3:[function(require,module,exports){(function(ng_app){ng_app.directive("href",function(Keyboard,Search){return{compile:function(element){element.attr("target","_blank")}}});ng_app.directive("search",["State",function(State){return{restrict:"A",link:function(scope,element,attrs){element.bind("click",function(ev){if(ev.target!==this){return}else{State.changeSubstate("SEARCH",false)}})}}}]);ng_app.directive("onkey",function(Keyboard,Search){return{link:function(scope,element,attrs){element.bind("keyup",function(ev){var key=ev.which||ev.keyCode;if(key===27||key===13||key>=37&&key<=40)Keyboard.getKey(key)});element.bind("keypress",function(ev){var key=ev.which||ev.keyCode;if(key===32||key>=48&&key<=122)Keyboard.getKey(key)})}}});ng_app.directive("navclick",["$rootScope","State","Search","Navigate",function($rootScope,State,Search,Navigate){return{restrict:"A",link:function(scope,element,attrs){var func=null;switch(attrs.navclick){case"zoom":func=function(){Navigate.current.zoom=!Navigate.current.zoom;Navigate.to(Navigate.current.index)};break;case"tile":func=function(){Navigate.to(attrs.index)};break;case"overlay":func=function(){State.toggleSubstate("OVERLAY")};break;case"search":func=function(){$rootScope.$broadcast("onkeyenter")};break;case"search_overlay":func=function(){State.toggleSubstate("SEARCH");ng_app.searchbar_search.focus()};break;case"grid":func=function(){State.toggleSubstate("LIST")};break;case"next":func=function(){Navigate.next()};break;case"prev":func=function(){Navigate.prev()};break;case"page_next":func=function(){Navigate.nextPage()};break;case"page_prev":func=function(){Navigate.prevPage()};break;case"info":func=function(){ng_app.modal_info.modal({keyboard:true})};break;case"options":func=function(){ng_app.modal_options.modal({keyboard:true})};break;case"help":func=function(){ng_app.modal_help.modal({keyboard:true})};break;case"about":func=function(){ng_app.modal_about.modal({keyboard:true})};break;default:func=function(){};break}element.bind("click",func)}}}])})(ng_hound)},{}],4:[function(require,module,exports){(function(ng_app,viewport){var normalize_url="https://arthound-server.herokuapp.com/get/normalize";ng_app.service("State",["$rootScope",function($rootScope){var self=this;self.state="DEFAULT";self.substates={FULL:false,SEARCH:false,LIST:false,LOAD:false,OVERLAY:false,LAST:false,FIRST:false};self.changeState=function(state){switch(state){case"DEFAULT":case"ACTIVE":self.state=state;$rootScope.$apply();$rootScope.$broadcast("onstatechange");break}};self.changeSubstate=function(substate,value){switch(substate){case"FULL":case"SEARCH":case"LOAD":case"OVERLAY":case"LIST":case"FIRST":case"LAST":self.substates[substate]=!!value;$rootScope.$apply();$rootScope.$broadcast("onsubstatechange");break}};self.toggleSubstate=function(substate){switch(substate){case"FULL":case"SEARCH":case"LOAD":case"OVERLAY":case"FIRST":case"LIST":case"LAST":self.substates[substate]=!self.substates[substate];$rootScope.$apply();$rootScope.$broadcast("onsubstatechange");break}};self.view_state="";self.view_last_state="";self.viewport=viewport;self.view_interval=50;self.view_can_change=true;$(document).ready(function(){self.view_state=viewport.current();self.view_last_state=self.view_state;$rootScope.$broadcast("onviewportchange");if(self.view_state==="xs"){self.changeSubstate("FULL",true)}if(self.view_state==="sm"||self.view_state==="md"||self.view_state==="lg"){self.changeSubstate("FULL",false)}$(window).resize(function(){if(self.view_can_change){self.view_can_change=false;self.view_state=viewport.current();if(self.view_state!==self.view_last_state){self.view_last_state=self.view_state;if(self.view_state==="xs"){self.changeSubstate("FULL",true)}if(self.view_state==="sm"||self.view_state==="md"||self.view_state==="lg"){self.changeSubstate("LIST",true);self.changeSubstate("FULL",false)}}setTimeout(function(){self.view_can_change=true},self.view_interval)}})})}]);ng_app.service("Keyboard",["$rootScope",function($rootScope){var self=this;self.key="";self.ord=null;self.getKey=function(key_code){self.key=key_code;if(key_code===32||key_code>=48&&key_code<=122){self.ord=String.fromCharCode(key_code)}else if(key_code===37){self.ord="LEFT"}else if(key_code===38){self.ord="UP"}else if(key_code===39){self.ord="RIGHT"}else if(key_code===40){self.ord="DOWN"}else if(key_code===13){self.ord="ENTER"}else if(key_code===27){self.ord="ESCAPE"}else{self.ord=null}self.broadcast()};self.broadcast=function(){switch(self.ord){case"LEFT":case"UP":case"RIGHT":case"DOWN":$rootScope.$broadcast("onkeyarrow");break;case"ESCAPE":$rootScope.$broadcast("onkeyesc");break;case"ENTER":$rootScope.$broadcast("onkeyenter");break;case"BACKSPACE":$rootScope.$broadcast("onkeybackspace");break;case null:break;default:$rootScope.$broadcast("onkeyup");break}}}]);ng_app.service("Search",["$rootScope","$http",function($rootScope,$http){var self=this;self.query="";self.response=[];self.sources={deviantart:true,e926:true,imgur:true};self.mature=false;self.temp_sources={};self.limit=24;self.clear=function(){self.query=""};self.clearResponse=function(){if(self.response.length>1){self.response=self.response.slice(1)}else{self.response.length=0}if(self.response.length===0)$rootScope.$broadcast("onsearchend")};self.disableSource=function(source){self.temp_sources[source]=false;var ignore=true;for(var key in self.temp_sources){if(source===key)self.temp_sources[key]=false;else if(self.temp_sources[key])ignore=false}if(ignore){$rootScope.$broadcast("onnosources")}};self.resetSources=function(){self.temp_sources=$.extend({},self.sources)};self.get=function(query,page,limit){var new_page=page||0;self.last_query=query||self.last_query||" ";self.limit=limit||self.limit;function request(url,data_type,source,options,headers){$.ajax({method:"GET",dataType:data_type,url:url,data:options,headers:headers||{}}).then(function success(res){if(res===undefined)res=[];if(res.query){var item=res.query.results.rss.channel.item||[];if(Array.isArray(item))res=item;else res=[item]}if(res.data){res=res.data||[]}if(res.length===0){return $.Deferred().resolve([]).promise()}console.log("Search Response",query,source,res);if(res.length>25){return $.when($.ajax({method:"POST",url:normalize_url,data:{source:source,body:res.slice(0,res.length*(1/4)),mature:self.mature}}),$.ajax({method:"POST",url:normalize_url,data:{source:source,body:res.slice(res.length*(1/4),res.length*(2/4)),mature:self.mature}}),$.ajax({method:"POST",url:normalize_url,data:{source:source,body:res.slice(res.length*(2/4),res.length*(3/4)),mature:self.mature}}),$.ajax({method:"POST",url:normalize_url,data:{source:source,body:res.slice(res.length*(3/4)),mature:self.mature}})).then(function success(res1,res2,res3,res4){var res_concat=res1[0].concat(res2[0],res3[0],res4[0]);return res_concat})}else{return $.ajax({method:"POST",url:normalize_url,data:{source:source,body:res,mature:self.mature}})}}).then(function success(res){self.response.push({source:source,page:new_page,data:res});$rootScope.$broadcast("onsearchreturned")},function error(res){console.error(res);self.response.push({source:source,page:new_page,data:[]});$rootScope.$broadcast("onsearchreturned")})}for(var key in self.temp_sources){if(self.temp_sources[key]){switch(key){case"e926":var query=self.last_query.split(" ");var new_query="";for(var i=query.length-2;i>0;i--){if(query[i]==="or"||query[i]==="OR"){query[i-1]="~"+query[i-1];query[i+1]="~"+query[i+1];query.splice(i,1)}else if(query[i]==="not"||query[i]==="NOT"){query[i+1]="-"+query[i+1];query.splice(i,1)}else if(query[i]==="and"||query[i]==="AND"){query.splice(i,1)}}new_query=query.join("+");var options={tags:new_query,page:new_page+1,limit:self.limit};if(self.mature){request("https://e621.net/post/index.json","jsonp","e926",options)}else{request("https://e926.net/post/index.json","jsonp","e926",options)}break;case"deviantart":var query=self.last_query.split(" ");var new_query="";for(var i=query.length-2;i>0;i--){if(query[i]==="or"){query[i]="OR"}else if(query[i]==="not"){query[i]="NOT"}else if(query[i]==="and"){query[i]="AND"}}new_query=encodeURIComponent(query.join(" "));var options=["?q=boost%3apopular%20"+encodeURIComponent(new_query).replace(/'/g,"%27").replace(/%20/g,"+"),"&limit="+self.limit,"&offset="+new_page*self.limit,"&order=9"].join("");var url="http://backend.deviantart.com/rss.xml"+options;var yqlURL=["http://query.yahooapis.com/v1/public/yql","?q="+encodeURIComponent("select * from xml where url='"+url+"'"),"&format=json&callback=?"].join("");request(yqlURL,"json","deviantart");break;case"imgur":var query=self.last_query.split(" ");var new_query="";for(var i=query.length-2;i>0;i--){if(query[i]==="or"){query[i]="OR"}else if(query[i]==="not"){query[i]="NOT"}else if(query[i]==="and"){query[i]="AND"}}new_query=query.join("+");var options={sort:"viral",q:"tag:"+new_query,page:new_page};var headers={Authorization:"Client-ID 1f63c77eaec2b1c"};request("https://api.imgur.com/3/gallery/search/","json","imgur",options,headers);break}}}return}}]);ng_app.service("Navigate",["$rootScope",function($rootScope){var self=this;self.initialize=function(limit){self.current={};self.current_limit=limit||3;self.current_index=0;self.current_page=0;self.index=0;self.last_index=0;self.display_low=0-self.current_limit;self.display_high=0+self.current_limit;self.can_page=false;self.listing_buffer=[];self.page_sizes=[]};self.initialize();self.append=function(response){if(response===null||response===undefined){console.error("Response is null or undefined")}var a=self.listing_buffer[response.page];if(self.listing_buffer[response.page]){self.listing_buffer[response.page].data.push.apply(self.listing_buffer[response.page].data,response.data)}else{self.listing_buffer[response.page]={page:response.page,data:response.data}}};self.reindex=function(){var start_index=0;for(var i=0;i<self.listing_buffer.length;i++){if(self.listing_buffer[i]){var b=self.listing_buffer[i];if(i>0){self.page_sizes[b.page]=b.data.length+self.page_sizes[i-1]}else{self.page_sizes[b.page]=b.data.length}var key="date";if(key!=="none"){self.listing_buffer[i].data.sort(function(a,b){return b[key]-a[key]})}for(var j=0;j<b.data.length;j++){b.data[j].index=start_index++}}else{self.page_sizes[i]=0;self.listing_buffer[i]={page:i,data:[]}}}self.last_index=start_index};self.checkDisplay=function(n){if(n<self.display_high&&n>self.display_low){return true}else{return false}};self.next=function(){if(self.index+1<self.last_index){self.index+=1;self.current=self.findByIndex(self.index);self.broadcast("onnavigate");return true}else if(self.index+1===self.last_index){self.nextPage()}else{return false}};self.prev=function(){if(self.index-1>=0){self.index-=1;self.current=self.findByIndex(self.index);self.broadcast("onnavigate");return true}else{return false}};self.to=function(n){n=Number(n);if(n>=0&&n<self.page_sizes[self.page_sizes.length-1]){self.index=n;self.current=self.findByIndex(self.index);self.broadcast("onnavigate");return true}else{return false}};self.prevPage=function(){if(!self.first_page&&self.can_page){self.can_page=false;self._calcPage(--self.current_page);self.broadcast("onnavigatepage")}};self.nextPage=function(){if(self.can_page){self.can_page=false;if(self.first_page)self.first_page=false;self.current_page=+self.listing_buffer[self.listing_buffer.length-1].page+1;self.broadcast("onnavigatepage")}};self.getDisplay=function(buffer){var retval=[];var low=self.display_low;var high=self.display_high;if(self.display_low<0)low=0;retval=buffer.slice(low,high);return retval};self.getPageByIndex=function(n){if(index<self.page_sizes[0]){return 0}else{for(var i=1;i<self.page_sizes.length;i++){if(self.page_sizes[i]>index){return i}}return null}};self.findByIndex=function(index){if(index>=self.page_sizes[0]){for(var i=1;i<self.page_sizes.length;i++){if(self.page_sizes[i]>index){var sub_index=index-self.page_sizes[i-1];return self.listing_buffer[i].data[sub_index]}}}else{return self.listing_buffer[0].data[index]}};self._calcPage=function(page){self.display_low=page-self.current_limit;if(self.display_low<=0)self.display_low=0;self.display_high=page+self.current_limit};self.broadcast=function(ev){$rootScope.$broadcast(ev)}}])})(ng_hound,ResponsiveBootstrapToolkit)},{}]},{},[1,4,2,3]);